#!/bin/bash
### Format: Rule MSG Proto Dst_addr Hits
TIMESTAMP="$(date +%F\ %T)"
EMAIL="$TIMESTAMP \n"
SMS=""
DATA=${1::-1}
IFS=';' read -r -a array <<< "$1"
#
#do
#rule="$(echo $1 | sed 's/,]/]/g' | jq --raw-output --argjson i $i '.rule[$i]')"
#if [ $rule != "null" ]
#then
#QUERY="{\"size\":1,\"query\":{\"match\":{\"json.rule\":\"$rule\"}}}"
#MSG="$(curl -s -XGET "http://localhost:9200/logstash-snort3j/_search" -H 'Content-Type: application/json' -d $QUERY | jq --raw-output '.hits.hits[]._source.json.msg')"
#PROTO="$(curl -s -XGET "http://localhost:9200/logstash-snort3j/_search" -H 'Content-Type: application/json' -d $QUERY | jq --raw-output '.hits.hits[]._source.json.proto')"
#DST_ADDR="$(curl -s -XGET "http://localhost:9200/logstash-snort3j/_search" -H 'Content-Type: application/json' -d $QUERY | jq --raw-output '.hits.hits[]._source.json.dst_addr')"
#HITS="$(echo $1 | sed 's/,]/]/g' | jq --raw-output --argjson i $i '.hits[$i]')"
#EMAIL="$EMAIL RULE :$rule, MSG: $MSG, PROTO $PROTO, DST_ADDR $DST_ADDR, HITS $HITS \n"
#SMS="${SMS} $rule,$MSG,$DST_ADDR|"
#fi
#i+=1
#done
#send Email
#EMAIL_ADDR="khoanase62625@fpt.edu.vn"
#echo -e $EMAIL | mutt -s "Snort Alert" $EMAIL_ADDR >> /dev/null 2>&1
#Send sms
#PHONENUMBER="+84933875926"
#adb shell am startservice --user 0 -n com.android.shellms/.sendSMS -e contact $PHONENUMBER -e msg "\"${SMS}\"" >> /dev/null 2>&1


